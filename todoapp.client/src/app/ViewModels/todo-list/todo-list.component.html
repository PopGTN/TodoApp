@if (isLoading) {
  <mat-progress-bar mode="query"></mat-progress-bar>
}
<main class="container overflow-hidden">
  @if (error) {
    {{ error }}
  }
  @if (!isLoading && todoItems) {
    <div class="mt-2 border-1 border-bottoms">
      <mat-chip-listbox attr.aria-label="{{ 'todoList.filterSelection' | transloco }}" [(ngModel)]="filterOption"
                        (change)="filterSelected($event)">
        <mat-chip-option [value]="FilterOption.completed">{{ 'todoList.completed' | transloco }}</mat-chip-option>
        <mat-chip-option [value]="FilterOption.notCompleted">{{ 'todoList.notCompleted' | transloco }}</mat-chip-option>
        <mat-chip-option [value]="FilterOption.todays">{{ 'todoList.todays' | transloco }}</mat-chip-option>
        <mat-chip-option [value]="FilterOption.tomorrows">{{ 'todoList.tomorrows' | transloco }}</mat-chip-option>
      </mat-chip-listbox>
    </div>
    @if (!error && todoItems) {
      <div class="">
        <ol class="list-group list-group-flush">
          @for (todoItem of todoItems; track todoItem.id; let index = $index) {
            <li class="list-group-item d-flex justify-content-between align-items-start p-2"
                (click)="openEditDialog(todoItem)">
              <div class="">
                <input type="checkbox" class="form-check-input d-flex  rounded-circle"
                       attr.aria-label="Check {{todoItem.title}} as completed!"
                       [(ngModel)]="todoItem.isComplete" (change)="taskComplete($event, todoItem)"
                       (click)="$event.stopPropagation();">
              </div>
              <div class="ms-2 me-auto">
                <div class="fw-bold">{{ todoItem.title }}</div>
                {{ todoItem.description }}
                <div class=" {{ !todoItem.dateTime ? 'd-none' : 'No' }}" style="font-size: 85%">
                  <small><span class="text-sm-center" placement="bottom" aria-label
                               ngbTooltip="{{ 'todoList.dateForTodo' | transloco }}" container="body"
                  >
                  <i class="bi bi-calendar me-1"></i> {{ todoItem.dateTime | date:'MM/dd/yyyy h:mm a' }}</span></small>
                </div>
              </div>
              <button id="editBtn" class="btn text-bg-primary rounded-pill me-1" placement="bottom" container="body"
                      ngbTooltip="{{ 'todoList.editTodo' | transloco }}"
                      tooltipClass="z-2"
                      attr.aria-label="{{ 'todoList.editTodo' | transloco }}"
                      (click)="openEditDialog($event, todoItem)">
                <i class="bi bi-pencil"></i>

              </button>
              <button class="btn text-bg-danger rounded-pill " placement="bottom" container="body"
                      ngbTooltip="{{ 'todoList.deleteTodo' | transloco }}"
                      tooltipClass="z-2"
                      attr.aria-label="{{ 'todoList.deleteTodo' | transloco }}"
                      (click)="openDeleteDialog($event, index, todoItem)">
                <i class=" bi bi-trash"></i>
              </button>


          </li>
        }
      </ol>
    </div>
    <div class="d-flex justify-content-center">
      <ngb-pagination [collectionSize]="todoItems.length" [(page)]="page" [maxSize]="5" [rotate]="true" [boundaryLinks]="true" />

    </div>
  }

</main>
